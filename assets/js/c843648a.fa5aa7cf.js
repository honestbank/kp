"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[870],{811:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"middlewares/consumer","title":"Consumer","description":"The consumer middleware is responsible for populating the chain with messages from the Kafka topic(s). Consumer middleware retrieves a message from the Kafka topic using the Consumer interface and passes it to the next middleware in the chain.","source":"@site/docs/middlewares/consumer.md","sourceDirName":"middlewares","slug":"/middlewares/consumer","permalink":"/kp/docs/middlewares/consumer","draft":false,"unlisted":false,"editUrl":"https://github.com/honestbank/kp/edit/main/docs/docs/middlewares/consumer.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"order-of-middleware","permalink":"/kp/docs/middlewares/order-of-middleware"},"next":{"title":"Backoff","permalink":"/kp/docs/middlewares/backoff"}}');var s=t(4848),o=t(8453);const i={sidebar_position:3},a="Consumer",c={},d=[];function m(e){const n={admonition:"admonition",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"consumer",children:"Consumer"})}),"\n",(0,s.jsx)(n.p,{children:"The consumer middleware is responsible for populating the chain with messages from the Kafka topic(s). Consumer middleware retrieves a message from the Kafka topic using the Consumer interface and passes it to the next middleware in the chain."}),"\n",(0,s.jsx)(n.p,{children:"The consumer middleware should be added before any other middleware that needs a message to be present."}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"By default, the middleware chain is empty. If the consumer of the library does not wish to read from Kafka, they can skip using the consumer middleware and even implement alternative message brokers, such as Amazon SQS."})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n\t"context"\n\t"fmt"\n\t"github.com/confluentinc/confluent-kafka-go/kafka"\n\tv2 "github.com/honestbank/kp/v2"\n\t"time"\n\n\tconsumer2 "github.com/honestbank/kp/v2/consumer"\n\t"github.com/honestbank/kp/v2/middlewares/consumer"\n)\n\nfunc main() {\n\tc, err := consumer.New([]string{"topic-1", "topic-2"}, getConfig())\n\tif err != nil {\n\t\t// handle err\n\t}\n\tconsumerMiddleware := consumer.NewConsumerMiddleware(c)\n\tprocessor := v2.New[kafka.Message]()\n\tprocessor.AddMiddleware(consumerMiddleware)\n\tprocessor.Process(processUserLoggedInEvent)\n}\n\nfunc processUserLoggedInEvent(ctx context.Context, message *kafka.Message) error {\n\t// here, you can focus on your business logic.\n\tfmt.Printf("processing %v\\n", message)\n\ttime.Sleep(time.Millisecond * 200) // simulate long running process\n\treturn nil                         // or error\n}\n\nfunc getConfig() any {\n\treturn nil // return your config\n}\n'})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var r=t(6540);const s={},o=r.createContext(s);function i(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);